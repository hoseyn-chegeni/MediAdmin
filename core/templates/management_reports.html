{% extends 'base.html'%}

{% block content%}
<div class="container">
<h2>performance management report</h2>
<!-- USERS -->
<p>total user = {{total_users}}</p>
<p>active user = {{active_users}}</p>
<p>accounts suspensions = {{accounts_suspensions}}</p>
<p> inactive_accounts = {{inactive_accounts}}</p>
<p>new users = {{new_users}}</p>
<!-- EQUIPMENTS -->
<p>total_equipment = {{total_equipment}}</p>
<p>equipment_utilization = {{equipment_utilization}} %</p>
<p>new_equipment = {{new_equipment}}</p>
<!-- APPOINTMENTS -->
<p>total_appointments = {{total_appointments}}</p>
<p>Completed Appointments = {{completed_appointments}}</p>
<p> missed_appointments = {{missed_appointments}}</p>
<p> cancelled_appointments = {{cancelled_appointments}}</p>
<!-- CLIENTS -->
<p>total_clients = {{total_clients}}</p>
<p>new_clients = {{new_clients}}</p>
<p>client_retention = {{client_retention}}</p>
<p>average_receptions_per_client = {{average_receptions_per_client}}</p>
<!-- CONSUMABLES -->
<p>total_consumables = {{total_consumables}}</p>
<p>low_stock_items = {{low_stock_items}}</p>
<p>new_consumable = {{new_consumable}}</p>
<p>expired_items = {{expired_items}}</p>
<p>total_expenditure = {{total_expenditure}}</p>
<!-- SUPPLIERS -->
<p>total_suppliers = {{total_suppliers}}</p>
<p>new_suppliers = {{new_suppliers}}</p>
<!-- DOCTORS -->
<p>total_doctors = {{total_doctors}}</p>
<p>new_doctors = {{new_doctors}}</p>
<p>average_appointments_per_doctor = {{average_appointments_per_doctor}}</p>
<!-- INVOICE -->
<p>total_invoices = {{total_invoices}}</p>
<p>paid_invoices = {{paid_invoices}}</p>
<p>unpaid_invoices = {{unpaid_invoices}}</p>
<p>average_invoice_value = {{average_invoice_value}}</p>
<p>total_invoice_amount = {{total_invoice_amount}}</p>
<p>average_invoices_per_client = {{average_invoices_per_client}}</p>
<!-- OFFICE EXPENSES -->
<p>total_expenses = {{total_expenses}}</p>
<!-- PRESCRIPTION -->
<p>total_prescription= {{total_prescription}}</p>
<p>average_prescriptions_per_doctor= {{average_prescriptions_per_doctor}}</p>
<p>new_prescription= {{new_prescription}}</p>
<p>average_prescriptions_per_client= {{average_prescriptions_per_client}}</p>
<!-- RECEPTION -->
<p>total_reception= {{total_reception}}</p>
<!-- SERVICE -->
<p>total_service= {{total_service}}</p>
<p>new_service= {{new_service}}</p>
<!-- TASk -->
<p>total_task= {{total_task}}</p>
<p>completed_task= {{completed_task}}</p>
<p>pending_task= {{pending_task}}</p>
<p>average_tasks_per_user= {{average_tasks_per_user}}</p>
</div>
<hr>
<hr>
<hr>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">User Group Distribution</h5>
                    <canvas id="userGroupChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>
<canvas id="appointmentTypesChart"></canvas>
<canvas id="dailyAppointmentsChart"></canvas>
<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">توزیع جنسیت مشتریان</h5>
                    <canvas id="genderChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">توزیع مشتریان VIP</h5>
                    <canvas id="vipChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>


<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">تعداد مشتریان بر اساس ارائه دهنده بیمه</h5>
                    <canvas id="insuranceProviderChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <div class="card mt-5">
                <div class="card-body">
                    <h5 class="card-title">توزیع دسته‌های مصرفی</h5>
                    <canvas id="consumableCategoriesChart"></canvas>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.js"></script>


<script>
    // Fetch data using AJAX
    fetch('{% url "charts:user_group_distribution_chart" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create pie chart
            var labels = data.labels;
            var data = data.data;

            // Create chart using Chart.js
            var ctx = document.getElementById('userGroupChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.5)',
                            'rgba(54, 162, 235, 0.5)',
                            'rgba(255, 206, 86, 0.5)',
                            'rgba(75, 192, 192, 0.5)',
                            'rgba(153, 102, 255, 0.5)',
                            'rgba(255, 159, 64, 0.5)',
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)',
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            display: false
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
<script>
    // Fetch data using AJAX
    fetch('{% url "charts:appointment_service_chart" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var labels = data.labels;
            var data = data.data;

            // Create chart using Chart.js
            var ctx = document.getElementById('appointmentTypesChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Appointment Types',
                        data: data,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.7)',
                            'rgba(54, 162, 235, 0.7)',
                            'rgba(255, 206, 86, 0.7)',
                            'rgba(75, 192, 192, 0.7)',
                            'rgba(153, 102, 255, 0.7)',
                            'rgba(255, 159, 64, 0.7)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    // Add options here if needed
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
<script>
    // Fetch data using AJAX
    fetch('{% url "charts:daily_appointments_chart" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var labels = data.labels;
            var data = data.data;

            // Create chart using Chart.js
            var ctx = document.getElementById('dailyAppointmentsChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Daily Appointments',
                        data: data,
                        fill: false,
                        borderColor: 'rgba(75, 192, 192, 1)',
                        borderWidth: 2
                    }]
                },
                options: {
                    // Add options here if needed
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>

<script>
    // Fetch data using AJAX
    fetch('{% url "charts:client_gender_distribution" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var labels = Object.keys(data);
            var counts = Object.values(data);

            // Create chart using Chart.js
            var ctx = document.getElementById('genderChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'توزیع جنسیت',
                        data: counts,
                        backgroundColor: ['#FF6384', '#36A2EB'], // Red for male, blue for female
                        borderWidth: 1
                    }]
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
<script>
    // Fetch data using AJAX
    fetch('{% url "charts:client_vip_distribution" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var labels = Object.keys(data);
            var counts = Object.values(data);

            // Create chart using Chart.js
            var ctx = document.getElementById('vipChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'توزیع مشتریان VIP',
                        data: counts,
                        backgroundColor: ['#FF6384', '#36A2EB'], // Red for VIP, blue for non-VIP
                        borderWidth: 1
                    }]
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>

<script>
    // Fetch data using AJAX
    fetch('{% url "charts:clients_by_insurance_chart" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var labels = Object.keys(data);
            var counts = Object.values(data);

            // Create chart using Chart.js
            var ctx = document.getElementById('insuranceProviderChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'تعداد مشتریان',
                        data: counts,
                        backgroundColor: '#4BC0C0',
                        borderWidth: 1
                    }]
                },
                options: {
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>


<script>
    // Fetch data using AJAX
    fetch('{% url "charts:consumable_categories_distribution" %}')
        .then(response => response.json())
        .then(data => {
            // Data received, create chart
            var ctx = document.getElementById('consumableCategoriesChart').getContext('2d');
            var chart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: data.labels,
                    datasets: [{
                        label: 'توزیع مصرفی‌ها',
                        data: data.counts,
                        backgroundColor: [
                            'rgba(255, 99, 132, 0.2)',
                            'rgba(54, 162, 235, 0.2)',
                            'rgba(255, 206, 86, 0.2)',
                            'rgba(75, 192, 192, 0.2)',
                            'rgba(153, 102, 255, 0.2)',
                            'rgba(255, 159, 64, 0.2)'
                        ],
                        borderColor: [
                            'rgba(255, 99, 132, 1)',
                            'rgba(54, 162, 235, 1)',
                            'rgba(255, 206, 86, 1)',
                            'rgba(75, 192, 192, 1)',
                            'rgba(153, 102, 255, 1)',
                            'rgba(255, 159, 64, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        tooltip: {
                            callbacks: {
                                label: function(tooltipItem) {
                                    return `${tooltipItem.label}: ${tooltipItem.raw}`;
                                }
                            }
                        }
                    }
                }
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
{%endblock%}